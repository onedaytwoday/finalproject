<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="product">
	<select id="selectList" resultType="productDto">
		SELECT PRODUCT_NO, PRODUCT_NAME, PRODUCT_CATEGORY, PRODUCT_PRICE, PRODUCT_DESC, PRODUCT_LOC,
		PRODUCT_DEL, PRODUCT_SALE
		FROM PRODUCT
		ORDER BY PRODUCT_NO
	</select>
	
	<select id="productList" parameterType="PagingDto" resultType="productDto">
		SELECT X.rnum,
		X.PRODUCT_NO, X.PRODUCT_NAME, X.PRODUCT_CATEGORY, X.PRODUCT_PRICE, X.PRODUCT_DESC, X.PRODUCT_LOC,
		X.PRODUCT_DEL, X.PRODUCT_SALE
		FROM (
		SELECT ROWNUM AS rnum,
		A.PRODUCT_NO, A.PRODUCT_NAME, A.PRODUCT_CATEGORY, A.PRODUCT_PRICE, A.PRODUCT_DESC, A.PRODUCT_LOC,
		A.PRODUCT_DEL, A.PRODUCT_SALE
		FROM (
		SELECT
		P.PRODUCT_NO, P.PRODUCT_NAME, P.PRODUCT_CATEGORY, P.PRODUCT_PRICE, P.PRODUCT_DESC, P.PRODUCT_LOC,
		P.PRODUCT_DEL, P.PRODUCT_SALE
		FROM PRODUCT p
		ORDER BY PRODUCT_NO DESC
		) A
		WHERE ROWNUM <![CDATA[ <= ]]>
		#{pageEnd}
		) X
		WHERE X.rnum <![CDATA[ >= ]]>
		#{pageBegin}
	</select>
	
	<select id="selectOne" parameterType="int" resultType="productDto">
		SELECT PRODUCT_NO, PRODUCT_NAME, PRODUCT_CATEGORY, PRODUCT_PRICE, PRODUCT_DESC, PRODUCT_LOC,
		PRODUCT_DEL, PRODUCT_SALE
		FROM PRODUCT
		WHERE PRODUCT_NO = #{product_no}
	</select>
	
	<select id="selectOneByName" parameterType="String" resultType="productDto">
		SELECT PRODUCT_NO, PRODUCT_NAME, PRODUCT_CATEGORY, PRODUCT_PRICE, PRODUCT_DESC, PRODUCT_LOC,
		PRODUCT_DEL, PRODUCT_SALE
		FROM PRODUCT
		WHERE PRODUCT_NAME = #{product_name}
	</select>
	
	<insert id="insert" parameterType="productDto">
		INSERT INTO PRODUCT
		VALUES(PRODUCT_NO_SEQ.NEXTVAL, #{product_name}, #{product_category}, #{product_price}, #{product_desc}, #{product_loc}, #{product_del},
		#{product_sale})
		<selectKey keyProperty="product_no" resultType="int" >
			SELECT PRODUCT_NO_SEQ.CURRVAL From DUAL
		</selectKey>
	</insert>
	
	<delete id="delete" parameterType="int">
		DELETE FROM PRODUCT 
		WHERE PRODUCT_NO = #{product_no}
	</delete>
	
	<select id="productCount" resultType="int">
		SELECT COUNT(PRODUCT_NO)
		FROM PRODUCT
	</select>
</mapper>
